(function(S,u,m,a,s,A,G,H,l){"use strict";const p=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(n){return typeof n=="object"&&!Array.isArray(n)};return[e,t(e[e.length-1])?e.pop():{}]},c=function(e,t){return t.all?a.findAll(e):a.find(e)},K=function(e){return c(e,{all:!0})},g={byProps:function(e){return function(t){return e.every(function(n){return t[n]!==void 0})}},byDisplayName:function(e,t){return t?function(n){return n?.displayName===e}:function(n){var r;return(n==null||(r=n.default)===null||r===void 0?void 0:r.displayName)===e}},byTypeName:function(e,t){return t?function(n){var r;return(n==null||(r=n.type)===null||r===void 0?void 0:r.name)===e}:function(n){var r,o;return(n==null||(o=n.default)===null||o===void 0||(r=o.type)===null||r===void 0?void 0:r.name)===e}},byName:function(e,t){return t?function(n){return n?.name===e}:function(n){var r;return(n==null||(r=n.default)===null||r===void 0?void 0:r.name)===e}}};var q=Object.freeze({__proto__:null,filters:g,getByDisplayName:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,o]=p(t);return c(g.byDisplayName(r[0],o.default),o)},getByName:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,o]=p(t);return c(g.byName(r[0],o.default),o)},getByProps:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,o]=p(t);return c(g.byProps(r),o)},getByTypeName:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const[r,o]=p(t);return c(g.byTypeName(r[0],o.default),o)},getModule:c,getModules:K});const I=a.common.constants,J=a.common.clipboard,Q=a.findByProps("registerAsset"),M=a.findByProps("receiveMessage","sendMessage"),D=a.findByProps("createBotMessage"),R=a.findByProps("BOT_AVATARS"),W=a.common.ReactNative.NativeModules,X=a.common.React,Y=a.common.FluxDispatcher,Z=a.findByProps("getItem"),ee=a.common.toasts,ne=a.findByProps("show","openLazy","close"),te=a.findByProps("getToken"),re=a.findByProps("getAPIBaseURL"),oe=a.findByProps("watchKeys"),ae=a.findByProps("getCurrentUser"),se=a.findByProps("getUser","fetchProfile"),ie=a.common.navigation,ue=a.common.NavigationNative,le=a.common.navigationStack,ce=a.findByProps("theme"),fe=a.common.ReactNative.Linking,z=a.common.stylesheet,ge={ThemeColorMap:s.semanticColors,Colors:s.rawColors},de=s.semanticColors,me=s.rawColors,pe={Forms:m.Forms,General:m.General},ye=a.findByProps("Messages"),ve=a.findByProps("showUserProfile"),he=a.findByProps("debounce","throttle"),be=a.findByName("Logger"),Pe=a.common.Flux,Be=a.findByProps("Svg"),Ne=a.findByName("getScreens",!1),_e=a.common.moment;I.ThemeColorMap=s.semanticColors,z.ThemeColorMap=s.semanticColors;var Te=Object.freeze({__proto__:null,Assets:Q,AsyncUsers:se,Avatars:R,Clipboard:J,Clyde:D,ColorMap:ge,Colors:me,Components:pe,Constants:I,Dialog:ne,Dispatcher:Y,Flux:Pe,Linking:fe,Locale:ye,Lodash:he,Logger:be,Messages:M,Moment:_e,Native:W,Navigation:ie,NavigationNative:ue,NavigationStack:le,Profiles:ve,REST:re,React:X,SVG:Be,Scenes:Ne,Settings:oe,Storage:Z,StyleSheet:z,Theme:ce,ThemeColorMap:de,Toasts:ee,Token:te,Users:ae});const f={};function v(e,t,n){return f[e]||(f[e]={before:[],instead:[],after:[]}),f[e][t].push(n),{unpatch:n}}function h(e,t){switch(e){case"before":return function(n,r){return t(this,n,r),r(...n)};case"instead":return function(n,r){return t(this,n,r)};case"after":return function(n,r){return t(this,n,r)}}}const k=function(e,t,n,r,o){return v(e,"before",u.patcher.instead(n,t,h("before",r),o))},$=function(e,t,n,r,o){return v(e,"instead",u.patcher.instead(n,t,h("instead",r),o))},j=function(e,t,n,r,o){return v(e,"after",u.patcher.after(n,t,h("after",r),o))},b=function(e){return[...f[e].before,...f[e].instead,...f[e].after]},O=function(e){return b(e).forEach(function(t){return t()})};var we=Object.freeze({__proto__:null,after:j,before:k,create:function(e){return{getPatchesByCaller:function(){return b(e)},before:function(t,n,r,o){return k(e,t,n,r,o)},instead:function(t,n,r,o){return $(e,t,n,r,o)},after:function(t,n,r,o){return j(e,t,n,r,o)},unpatchAll:function(){return O(e)}}},getPatchesByCaller:b,instead:$,unpatchAll:O});function P(e,t){return u.logger.warn(`Tried to call ${e}, not implemented!`),t}const x={};function B(e,t){x[e]??=[];for(const n of t)x[e].push(H.registerCommand({name:n.name,displayName:n.name,description:n.description,displayDescription:n.description,type:1,inputType:1,applicationId:"-1",options:n.options,execute:n.execute}))}const L=function(e){var t;return(t=B[e])===null||t===void 0?void 0:t.forEach(function(n){return n()})};var Ce=Object.freeze({__proto__:null,registerCommands:B,unregisterCommands:L});A.storage.plugins??={};let N={},i=A.storage.plugins;function U(e){if(typeof e!="object")return;const t=Object.entries(i).find(function(n){let[,r]=n;return r.name===e.name})[0];N[t]={onStart:e.onStart,onStop:e.onStop,onEnable:function(){try{e.onStart(),e.commands&&B(e.name,e.commands)}catch(n){console.error(`${e.name} errored while enabling`,n.message)}},onDisable:function(){try{e.patches&&e.patches.forEach(function(n){return n.unpatchAll()}),e.commands&&L(e.name),e.onStop()}catch(n){console.error(`${e.name} errored while disabling`,n.message)}}}}const E=function(e,t){return G.without({...e,...t},"script","enabled")},_=function(e){return(e?Object.entries(i).filter(e):Object.entries(i)).map(function(t){let[n,r]=t;return E(r,N[n])})};function Se(e){const[t,n]=Object.entries(i).find(function(r){let[,o]=r;return o.name===e});return E(n,N[t])}const Ae=function(){return _()},Ie=function(){return _(function(e){let[,t]=e;return t.enabled})},Me=function(){return _(function(e){let[,t]=e;return!t.enabled})},De=function(e){return new Proxy(globalThis.enmity.plugins,{get(t,n){return n!=="registerPlugin"?Reflect.get(t,n):function(r){return i[e]??={name:r.name,description:r.description,version:r.version,authors:r.authors},U(r)}}})};async function F(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;var n;const r=((n=i[e])===null||n===void 0?void 0:n.script)??await(await fetch(e)).text(),o={...globalThis.enmity,plugins:De(e)},y=new Proxy(window,{get(w,C){if(C==="window")return y;switch(C){case"vendetta":case"__vendetta_theme":case"__vendetta_loader":case"__vendetta_rdc":return;case"enmity":return o;default:return w[C]}}});try{await(0,eval)(`((window, enmity) => { ${r} })`)(y,o)}catch(w){console.error(w.stack)}return i[e].script=r,i[e].enabled=t,i[e].name}function Re(e,t){F(e,!0)}var ze=Object.freeze({__proto__:null,evalPlugin:F,getDisabledPlugins:Me,getEnabledPlugins:Ie,getPlugin:Se,getPlugins:Ae,installPlugin:Re,registerPlugin:U,uninstallPlugin:async function(){return P("uninstallPlugin")}});function ke(e,t,n,r){const o=D.createBotMessage({channelId:e,content:""});o.author.username=n??"Fellowship",o.author.avatar=r?n:"clyde",r&&R.BOT_AVATARS[n],typeof t=="string"?o.content=t:Object.assign(o,t),M.receiveMessage(e,o)}var $e=Object.freeze({__proto__:null,sendReply:ke});const{uuid4:je}=a.findByProps("uuid4"),Oe=function(e){return l.lodash.memoize(e)},xe=function(e,t){return l.lodash.debounce(e,t)},Le=function(){return P("createStore",{})},Ue=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(r){return r},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return u.utils.findInTree(e,t,{walkable:["props","children"],...n})},Ee=l.ReactNative.PixelRatio.getPixelSizeForLayoutSize;var Fe=Object.freeze({__proto__:null,createStore:Le,debounce:xe,findInReactTree:Ue,findInTree:function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(y){return y},{ignore:n=[],walkable:r=[],maxProperties:o=100}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return u.utils.findInTree(e,t,{ignore:n,walkable:r,maxDepth:o})},memoize:Oe,normalizeSize:Ee,sleep:function(e){return new Promise(function(t){return setTimeout(t,e)})},uuid:je,wrapInHooks:function(){return P("wrapInHooks",l.React.createElement(l.ReactNative.Text,{},"Stubbed wrapInHooks"))}});const{NativeModules:d}=l.ReactNative,T=d.InfoDictionaryManager??d.RTNClientInfoManager,V=d.DCDDeviceManager??d.RTNDeviceManager,Ve=d.BundleUpdaterManager,Ge=T.Identifier,He=Ve.reload,Ke=T.Version,qe=V.systemVersion,Je=T.Build,Qe=V.device;var We=Object.freeze({__proto__:null,build:Je,bundle:Ge,device:Qe,os:qe,reload:He,version:Ke});const Xe=s.assets.all,Ye=s.assets.find,Ze=function(e){return s.assets.getAssetByName(e)},en=function(e){return s.assets.getAssetByID(e)},nn=function(e){return s.assets.getAssetIDByName(e)},tn=new Proxy({},{get:function(e,t){return s.assets.getAssetIDByName(t)}});var rn=Object.freeze({__proto__:null,Icons:tn,assets:Xe,find:Ye,getByID:en,getByName:Ze,getIDByName:nn});function on(){return globalThis.enmity={modules:{...q,common:Te},patcher:we,version:`Fellowship ${u.plugin.manifest.hash.slice(7)}`,plugins:ze,clyde:$e,commands:Ce,utilities:Fe,components:new Proxy({},{get:function(e,t){return m.General[t]??m.Forms[t]}}),native:We,assets:rn},function(){return delete globalThis.enmity}}const an=[on()],sn=function(){return an.forEach(function(e){return e()})};return S.onUnload=sn,S})({},vendetta,vendetta.ui.components,vendetta.metro,vendetta.ui,vendetta.plugin,vendetta.utils,vendetta.commands,vendetta.metro.common);
